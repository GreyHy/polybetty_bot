# Telegram 社交投机机器人

这是一个基于区块链的Telegram投注机器人项目，集成了Monad测试网。用户可以通过Telegram创建投注、使用内联键盘选择投注选项，并在Monad测试网上结算结果。

## 功能

- `/start` - 欢迎用户，提供基本介绍
- `/createbet` - 创建新的投注，自动显示视觉吸引力的投注摘要和选项按钮
- `/joinbet` - 加入现有投注（也可通过内联键盘按钮直接选择选项和金额）
- `/resolvebet` - 解决投注（仅限创建者）
- `/betinfo` - 查询投注信息，显示美观的投注摘要和选项按钮
- `/claimwinnings` - 获奖者领取奖金

### 特色功能

- **内联键盘选项** - 用户可直接点击按钮选择投注选项和金额
- **视觉引人入胜的投注摘要** - 使用表情符号和格式化文本增强显示效果
- **Monad测试网集成** - 支持在Monad测试网创建和解决投注
- **测试模式** - 可在无真实代币的环境中模拟投注流程

## 技术栈

- **Telegram Bot**: grammY (TypeScript) - 使用内联键盘和富文本格式增强用户体验
- **后端服务**: Fastify (Node.js/TypeScript) - 提供API接口和测试模式支持
- **智能合约**: Solidity - 部署在Monad测试网上的投注合约
- **区块链交互**: ethers.js - 与Monad测试网交互
- **样式**: 使用MarkdownV2格式和表情符号提升视觉体验

## 项目结构

```
bet/
├── src/
│   ├── bot/          # Telegram 机器人模块
│   ├── api/          # Fastify 后端服务
│   ├── blockchain/   # 区块链相关代码
│   └── shared/       # 共享模块
└── test/            # 测试目录
```

## 安装与运行

1. 安装依赖
```
npm install
```

2. 配置环境变量
```
cp .env.example .env
# 编辑 .env 文件填写必要配置
```

3. 编译智能合约
```
npm run compile:contracts
```

4. 开发模式运行
```
# 启动 API 后端
npm run dev:api

# 启动 Telegram 机器人
npm run dev:bot
```

5. 生产模式运行
```
npm run build
npm run start:api
npm run start:bot
```

## 用户体验优化

项目实现了多种用户体验优化：

1. **内联键盘交互**
   - 点击选项按钮直接加入投注
   - 选择预设金额或输入自定义金额
   - 查看详情按钮快速访问投注信息

2. **视觉增强**
   - 使用表情符号表示投注状态和选项
   - 采用分隔线增强结构化显示
   - 数字表情符号标记选项编号

3. **错误处理**
   - 所有错误消息使用一致的格式和表情符号
   - 改进的验证流程确保准确的错误信息
   - 最近修复了“解决投注”功能的问题

## Monad测试网集成

项目与Monad测试网集成，提供以下特性：

1. **智能合约部署**
   - 投注合约部署在Monad测试网上
   - 支持测试USDC代币进行下注

2. **区块链交互优化**
   - 自动设置gas限制解决测试网估算问题
   - 完善的错误处理和日志记录

3. **测试模式**
   - 在测试环境下模拟投注操作
   - 无需真实交互即可测试机器人功能

## 版本历史

### v1.1.0

- 添加内联键盘功能
- 增强信息显示视觉效果
- 修复解决投注功能的错误
- 改进用户交互流程

### v1.0.0

- 初始版本
- 实现基本的投注创建和参与功能
